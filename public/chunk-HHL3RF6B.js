import{a as Ue}from"./chunk-EO435ZWV.js";import{a as ue,b as s,c as ge,d as pe,e as fe,f as v,g as he,h as _e,i as ve,j as be,k as xe,l as Ce,m as Pe,n as Se,o as we,p as Ee,q as Ve,r as ye}from"./chunk-RD5OQEZ5.js";import{a as me}from"./chunk-VQA6DLDJ.js";import{$ as ie,A as q,B as l,C as P,Ca as ae,Da as le,F as p,Ga as se,H as u,I as y,Ia as ce,J as r,Ja as de,K as i,L as h,La as $,M as S,Ma as B,N as _,O as f,P as J,Q as X,R as F,S as L,T as N,U as n,W as U,X as ee,Z as D,_ as te,a as M,b as k,ba as re,d as Z,e as I,ea as oe,fa as A,g as K,ga as ne,ha as z,na as j,q as T,v as b,w as x,z as Y}from"./chunk-OXL5UCVD.js";var C=Z(me());var R=Z(me());function qe(t,d){if(t&1&&(r(0,"p",11)(1,"strong"),n(2,"Especialidad:"),i(),n(3),i()),t&2){let o=f().$implicit;l(3),U(" ",o.especialidad," ")}}function Fe(t,d){if(t&1&&(r(0,"p",11)(1,"strong"),n(2,"Especialidad:"),i(),n(3),i()),t&2){let o=f().$implicit;l(3),U(" ",o.otraEspecialidad," ")}}function Le(t,d){if(t&1&&(r(0,"p",11)(1,"strong"),n(2,"Obra Social:"),i(),n(3),i()),t&2){let o=f().$implicit;l(3),U(" ",o.obrasocial," ")}}function Ne(t,d){if(t&1){let o=S();r(0,"button",16),_("click",function(){b(o);let a=f(2).$implicit,m=f();return x(m.aprobarUsuario(a.id))}),n(1," Habilitar "),i()}}function De(t,d){if(t&1){let o=S();r(0,"button",17),_("click",function(){b(o);let a=f(2).$implicit,m=f();return x(m.inhabilitarUsuario(a.id))}),n(1," Inhabilitar "),i()}}function Ae(t,d){if(t&1&&(r(0,"div"),p(1,Ne,2,0,"button",14)(2,De,2,0,"button",15),i()),t&2){let o=f().$implicit;l(),u("ngIf",!o.aprobadoPorAdmin),l(),u("ngIf",o.aprobadoPorAdmin)}}function ze(t,d){if(t&1&&(r(0,"div",7),h(1,"img",8),r(2,"div",9)(3,"h5",10),n(4),i(),r(5,"p",11)(6,"strong"),n(7,"DNI:"),i(),n(8),i(),r(9,"p",11)(10,"strong"),n(11,"Edad:"),i(),n(12),i(),r(13,"p",11)(14,"strong"),n(15,"Email:"),i(),n(16),i(),p(17,qe,4,1,"p",12)(18,Fe,4,1,"p",12)(19,Le,4,1,"p",12)(20,Ae,3,2,"div",13),i()()),t&2){let o=d.$implicit;l(),X("alt","Imagen de ",o.nombre,""),u("src",o.role==="admin"&&o.imagenPerfil?o.imagenPerfil:o.role==="paciente"?o.imagenPerfil1:o.imagenPerfil,q),l(3),ee("",o.nombre," ",o.apellido,""),l(4),U(" ",o.dni,""),l(4),U(" ",o.edad,""),l(4),U(" ",o.mail,""),l(),u("ngIf",o.role==="especialista"&&o.especialidad!=="otra"),l(),u("ngIf",o.role==="especialista"&&o.especialidad==="otra"),l(),u("ngIf",o.role==="paciente"),l(),u("ngIf",o.role==="especialista")}}var W=(()=>{let d=class d{constructor(e,a){this.authService=e,this.router=a,this.usuarios=[],this.filteredUsuarios=[]}ngOnInit(){this.cargarUsuarios()}cargarUsuarios(){return I(this,null,function*(){this.authService.obtenerUsuarios().then(e=>{this.usuarios=e,this.filteredUsuarios=this.usuarios}).catch(e=>{console.error("Error al cargar usuarios:",e)})})}filterUsers(e){e==="all"?this.filteredUsuarios=this.usuarios:this.filteredUsuarios=this.usuarios.filter(a=>a.role===e)}aprobarUsuario(e){this.authService.aprobarUsuario(e).then(()=>{R.default.fire("Usuario habilitado","El usuario ha sido habilitado correctamente.","success"),this.cargarUsuarios()}).catch(a=>{R.default.fire("Error","No se pudo habilitar el usuario.","error"),console.error("Error al aprobar usuario:",a)})}inhabilitarUsuario(e){this.authService.inhabilitarUsuario(e).then(()=>{R.default.fire("Usuario inhabilitado","El usuario ha sido inhabilitado correctamente.","success"),this.cargarUsuarios()}).catch(a=>{R.default.fire("Error","No se pudo inhabilitar el usuario.","error"),console.error("Error al inhabilitar usuario:",a)})}};d.\u0275fac=function(a){return new(a||d)(P(B),P(j))},d.\u0275cmp=T({type:d,selectors:[["app-lista-usuarios"]],standalone:!0,features:[D],decls:13,vars:1,consts:[[1,"filter-container","mb-3","text-center"],[1,"btn","btn-primary","m-2",3,"click"],[1,"btn","btn-secondary","m-2",3,"click"],[1,"btn","btn-success","m-2",3,"click"],[1,"btn","btn-info","m-2",3,"click"],[1,"user-cards-container"],["class","card user-card",4,"ngFor","ngForOf"],[1,"card","user-card"],[1,"card-img-top","user-img",3,"src","alt"],[1,"card-body"],[1,"card-title"],[1,"card-text"],["class","card-text",4,"ngIf"],[4,"ngIf"],["class","btn btn-success",3,"click",4,"ngIf"],["class","btn btn-danger",3,"click",4,"ngIf"],[1,"btn","btn-success",3,"click"],[1,"btn","btn-danger",3,"click"]],template:function(a,m){a&1&&(r(0,"h2"),n(1,"Lista de Usuarios"),i(),r(2,"div",0)(3,"button",1),_("click",function(){return m.filterUsers("all")}),n(4,"Todos"),i(),r(5,"button",2),_("click",function(){return m.filterUsers("admin")}),n(6,"Administradores"),i(),r(7,"button",3),_("click",function(){return m.filterUsers("especialista")}),n(8,"Especialistas"),i(),r(9,"button",4),_("click",function(){return m.filterUsers("paciente")}),n(10,"Pacientes"),i()(),r(11,"div",5),p(12,ze,21,12,"div",6),i()),a&2&&(l(12),u("ngForOf",m.filteredUsuarios))},dependencies:[z,oe,A],styles:[".user-cards-container[_ngcontent-%COMP%]{height:440px;display:flex;gap:10px;overflow-x:auto;white-space:nowrap;padding:10px}.user-card[_ngcontent-%COMP%]{flex:0 0 auto;height:420px;width:300px;margin-right:10px;border-radius:8px;box-shadow:0 4px 8px #0000001a}.user-img[_ngcontent-%COMP%]{height:150px;object-fit:cover}.card-body[_ngcontent-%COMP%]{text-align:center}.filter-container[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]{background-color:#a72892!important;border-color:#a72892!important;color:#fff}.filter-container[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]:hover{background-color:#871f72!important;border-color:#871f72!important}"]});let t=d;return t})();var je=["formulario"],$e=["topElement"];function Be(t,d){if(t&1&&h(0,"img",13),t&2){let o=f().ngIf;J("src",o.photoURL,q)}}function Qe(t,d){t&1&&h(0,"img",14)}function Ge(t,d){if(t&1){let o=S();r(0,"a",10),_("click",function(){b(o);let a=f();return x(a.toggleDropdown())}),p(1,Be,1,1,"img",11)(2,Qe,1,0,"img",12),n(3),i()}if(t&2){let o=d.ngIf;l(),u("ngIf",o.photoURL),l(),u("ngIf",!o.photoURL),l(),U(" ",o.displayName?o.displayName:o.email," ")}}function We(t,d){if(t&1){let o=S();r(0,"button",17),_("click",function(){b(o);let a=f(2);return x(a.logout())}),h(1,"i",18),n(2," Cerrar Sesi\xF3n "),i()}}function He(t,d){if(t&1&&(r(0,"div",15),p(1,We,3,0,"button",16),i()),t&2){let o=f();l(),u("ngIf",o.showLogoutButton)}}function Ze(t,d){t&1&&(r(0,"div",19)(1,"div",20),h(2,"div",21),r(3,"p",22),n(4,"Creando usuario..."),i()()())}function Ke(t,d){t&1&&(r(0,"div",48),n(1," Por favor, ingrese su nombre. "),i())}function Ye(t,d){t&1&&(r(0,"div",48),n(1," Por favor, ingrese su apellido. "),i())}function Je(t,d){t&1&&(r(0,"div",48),n(1," Por favor, ingrese su edad. Debe ser mayor de 18. "),i())}function Xe(t,d){t&1&&(r(0,"div",48),n(1," Por favor, ingrese su DNI. Deben ser 8 caracteres sin punto. "),i())}function et(t,d){t&1&&(r(0,"div",48),n(1," Por favor, complete su mail. "),i())}function tt(t,d){t&1&&(r(0,"div",48),n(1," Por favor, ingrese su contrase\xF1a. Deben ser como minimo 6 caracteres. "),i())}function it(t,d){t&1&&(r(0,"div",48),n(1," Por favor, reingrese su contrase\xF1a. "),i())}function rt(t,d){t&1&&(r(0,"div",48),n(1," Debes cargar una imagen. "),i())}function ot(t,d){if(t&1){let o=S();r(0,"div")(1,"label",49),n(2,"Imagen de perfil"),i(),r(3,"input",50),_("change",function(a){b(o);let m=f(2);return x(m.onFileSelected0(a))}),i(),p(4,rt,2,0,"div",33),i()}if(t&2){let o,e=f(2);l(4),u("ngIf",(o=e.formReg.get("imagenPerfil0"))==null?null:o.hasError("required"))}}function nt(t,d){t&1&&(r(0,"div",48),n(1," Por favor, ingrese su obra social. V\xE1lido solo caracteres alfab\xE9ticos. "),i())}function at(t,d){t&1&&(r(0,"div",48),n(1," Debes cargar una imagen. "),i())}function lt(t,d){t&1&&(r(0,"div"),n(1," Debes cargar una imagen v\xE1lida. "),i())}function st(t,d){t&1&&(r(0,"div"),n(1," La imagen tiene un tama\xF1o incorrecto. "),i())}function ct(t,d){t&1&&(r(0,"div",48),n(1," Debes cargar una imagen. "),i())}function dt(t,d){if(t&1){let o=S();r(0,"div")(1,"label",51),n(2,"Obra Social"),i(),h(3,"input",52),p(4,nt,2,0,"div",33),r(5,"label",53),n(6,"Imagen de perfil 1"),i(),r(7,"input",54),_("change",function(a){b(o);let m=f(2);return x(m.onFileSelected1(a))}),i(),p(8,at,2,0,"div",33)(9,lt,2,0,"div",46)(10,st,2,0,"div",46),r(11,"label",55),n(12,"Imagen de perfil 2"),i(),r(13,"input",56),_("change",function(a){b(o);let m=f(2);return x(m.onFileSelected2(a))}),i(),p(14,ct,2,0,"div",33),i()}if(t&2){let o,e,a,m,g=f(2);l(3),y("campo-con-error",g.getValue("obraSocial").invalid&&(g.getValue("obraSocial").touched||g.getValue("obraSocial").dirty)),l(),u("ngIf",g.getValue("obraSocial").invalid&&(g.getValue("obraSocial").touched||g.getValue("obraSocial").dirty)),l(4),u("ngIf",(o=g.formReg.get("imagenPerfil1"))==null?null:o.hasError("required")),l(),u("ngIf",(e=g.formReg.get("imagenPerfil1"))==null?null:e.hasError("invalidImage")),l(),u("ngIf",(a=g.formReg.get("imagenPerfil1"))==null?null:a.hasError("invalidSize")),l(4),u("ngIf",(m=g.formReg.get("imagenPerfil2"))==null?null:m.hasError("required"))}}function mt(t,d){t&1&&(r(0,"div",48),n(1," Debe seleccionar una opci\xF3n. "),i())}function ut(t,d){t&1&&(r(0,"div",48),n(1," Valido solo caracteres alfab\xE9ticos. "),i())}function gt(t,d){if(t&1&&(r(0,"div",66)(1,"label",67),n(2,"Otra Especialidad"),i(),h(3,"input",68),p(4,ut,2,0,"div",33),i()),t&2){let o=f(3);l(3),y("campo-con-error",o.getValue("otraEspecialidad").invalid&&(o.getValue("otraEspecialidad").touched||o.getValue("otraEspecialidad").dirty)),l(),u("ngIf",o.getValue("otraEspecialidad").invalid&&(o.getValue("otraEspecialidad").touched||o.getValue("otraEspecialidad").dirty))}}function pt(t,d){t&1&&(r(0,"div",48),n(1," Debes cargar una imagen. "),i())}function ft(t,d){if(t&1){let o=S();r(0,"div")(1,"label",57),n(2,"Especialidad"),i(),r(3,"select",58)(4,"option",59),n(5,"Ginecologia"),i(),r(6,"option",60),n(7,"Traumatologia"),i(),r(8,"option",61),n(9,"Kinesiologia"),i(),r(10,"option",62),n(11,"Nutricionista"),i(),r(12,"option",63),n(13,"Otra"),i()(),p(14,mt,2,0,"div",33)(15,gt,5,3,"div",64),r(16,"label",49),n(17,"Imagen de perfil"),i(),r(18,"input",65),_("change",function(a){b(o);let m=f(2);return x(m.onFileSelected(a))}),i(),p(19,pt,2,0,"div",33),i()}if(t&2){let o,e,a=f(2);l(14),u("ngIf",a.getValue("especialidad").invalid&&(a.getValue("especialidad").touched||a.getValue("especialidad").dirty)),l(),u("ngIf",((o=a.formReg.get("especialidad"))==null?null:o.value)==="otra"),l(4),u("ngIf",(e=a.formReg.get("imagenPerfil"))==null?null:e.hasError("required"))}}function ht(t,d){if(t&1){let o=S();r(0,"div",23)(1,"h2"),n(2,"Crear usuario"),i(),r(3,"form",24),_("ngSubmit",function(){b(o);let a=f();return x(a.onSubmit())}),r(4,"div",25)(5,"label",26),n(6,"Tipo de Usuario:"),i(),r(7,"select",27)(8,"option",28),n(9,"Administrador"),i(),r(10,"option",29),n(11,"Especialista"),i(),r(12,"option",30),n(13,"Paciente"),i()()(),r(14,"div",25)(15,"label",31),n(16,"Nombre"),i(),h(17,"input",32),p(18,Ke,2,0,"div",33),r(19,"label",34),n(20,"Apellido"),i(),h(21,"input",35),p(22,Ye,2,0,"div",33),r(23,"label",36),n(24,"Edad"),i(),h(25,"input",37),p(26,Je,2,0,"div",33),r(27,"label",38),n(28,"DNI"),i(),h(29,"input",39),p(30,Xe,2,0,"div",33),r(31,"label",40),n(32,"Mail"),i(),h(33,"input",41),p(34,et,2,0,"div",33),r(35,"label",42),n(36,"Contrase\xF1a"),i(),h(37,"input",43),p(38,tt,2,0,"div",33),r(39,"label",44),n(40,"Reingresar contrase\xF1a"),i(),h(41,"input",45),p(42,it,2,0,"div",33),i(),p(43,ot,5,1,"div",46)(44,dt,15,7,"div",46)(45,ft,20,3,"div",46),i(),r(46,"div",8)(47,"button",47),_("click",function(){b(o);let a=f();return x(a.onSubmit())}),n(48,"Registrar"),i()()()}if(t&2){let o,e,a,m,g,w,c=f();l(3),u("formGroup",c.formReg),l(14),y("campo-con-error",c.getValue("nombre").invalid&&(c.getValue("nombre").touched||c.getValue("nombre").dirty)),l(),u("ngIf",((o=c.getValue("nombre"))==null?null:o.invalid)&&(c.getValue("nombre").touched||c.getValue("nombre").dirty)),l(3),y("campo-con-error",c.getValue("apellido").invalid&&(c.getValue("apellido").touched||c.getValue("apellido").dirty)),l(),u("ngIf",((e=c.getValue("apellido"))==null?null:e.invalid)&&(c.getValue("apellido").touched||c.getValue("apellido").dirty)),l(3),y("campo-con-error",c.getValue("edad").invalid&&(c.getValue("edad").touched||c.getValue("edad").dirty)),l(),u("ngIf",((a=c.getValue("edad"))==null?null:a.invalid)&&(c.getValue("edad").touched||c.getValue("edad").dirty)),l(3),y("campo-con-error",c.getValue("dni").invalid&&(c.getValue("dni").touched||c.getValue("dni").dirty)),l(),u("ngIf",c.getValue("dni").invalid&&(c.getValue("dni").touched||c.getValue("dni").dirty)),l(3),y("campo-con-error",c.getValue("email").invalid&&(c.getValue("email").touched||c.getValue("email").dirty)),l(),u("ngIf",c.getValue("email").invalid&&(c.getValue("email").touched||c.getValue("email").dirty)),l(3),y("campo-con-error",c.getValue("password").invalid&&(c.getValue("password").touched||c.getValue("password").dirty)),l(),u("ngIf",c.getValue("password").invalid&&(c.getValue("password").touched||c.getValue("password").dirty)),l(3),y("campo-con-error",c.getValue("confirmPassword").invalid&&(c.getValue("confirmPassword").touched||c.getValue("confirmPassword").dirty)),l(),u("ngIf",c.getValue("confirmPassword").invalid&&(c.getValue("confirmPassword").touched||c.getValue("confirmPassword").dirty)),l(),u("ngIf",((m=c.formReg.get("selectedRole"))==null?null:m.value)==="admin"),l(),u("ngIf",((g=c.formReg.get("selectedRole"))==null?null:g.value)==="paciente"),l(),u("ngIf",((w=c.formReg.get("selectedRole"))==null?null:w.value)==="especialista")}}var qt=(()=>{let d=class d{constructor(e,a,m,g,w,c,E){this.cdr=e,this.formBuilder=a,this.ImagenesService=m,this.authService=g,this.router=w,this.firestore=c,this.auth=E,this.selectedRole="",this.showLoading=!0,this.showLoadingUser=!1,this.usuariosPendientes=[],this.botonHabilitar=!0,this.botonInhabilitar=!0,this.imagenPerfil0=null,this.imagenPerfil=null,this.imagenPerfil1=null,this.imagenPerfil2=null,this.showCaptcha=!1,this.crearUsuarioVisible=!1,this.animacionCrearUsuario=!1,this.usuarios=[],this.mostrarFormulario=!1,this.onToggleSideNav=new Y,this.collapsed=!1,this.screenWidth=0,this.isDropdownOpen=!1,this.showLogoutButton=!1,this.currentUser$=this.authService.getCurrentUser(),this.formReg=new fe({selectedRole:new v("",[s.required]),nombre:new v("",[s.required,s.minLength(2),s.maxLength(20),s.pattern(/^[a-zA-Z\s]+$/)]),apellido:new v("",[s.required,s.minLength(3),s.pattern(/^[a-zA-Z\s]+$/)]),edad:new v("",[s.required,s.pattern("^[0-9]+"),s.min(18),s.max(99)]),dni:new v("",[s.required,s.pattern("^[0-9]+"),s.minLength(6),s.maxLength(8)]),obraSocial:new v("",[s.required,s.pattern(/^[a-zA-Z\s]+$/)]),email:new v("",[s.email,s.required]),password:new v("",[s.required,s.minLength(6)]),confirmPassword:new v("",[s.required]),especialidad:new v("",[s.required]),otraEspecialidad:new v("",[s.required,s.minLength(4),s.maxLength(25),s.pattern(/^[a-zA-Z]+$/)]),imagenPerfil0:new v("",[s.required]),imagenPerfil:new v("",[s.required]),imagenPerfil1:new v("",[s.required]),imagenPerfil2:new v("",[s.required])});let Q=this.formReg.get("selectedRole");Q&&Q.valueChanges.pipe(K(H=>{this.updateValidators(H)})).subscribe()}ngOnInit(){this.cargarUsuarios(),setTimeout(()=>{this.showLoading=!1},2e3),this.screenWidth=window.innerWidth,this.currentUser$=this.authService.getCurrentUser(),this.cargarUsuariosPendientes()}cargarUsuarios(){this.authService.obtenerUsuarios().then(e=>{this.usuarios=e}).catch(e=>{console.error("Error al cargar usuarios:",e)})}goTo(e){this.router.navigate([e])}toggleFormulario(){this.mostrarFormulario=!this.mostrarFormulario,this.mostrarFormulario?(this.animacionCrearUsuario=!0,setTimeout(()=>{let e=document.getElementById("crear-usuario-form");e&&e.scrollIntoView({behavior:"smooth"})},100)):this.animacionCrearUsuario=!1}scrollToFormulario(){this.formulario&&this.formulario.nativeElement&&this.formulario.nativeElement.scrollIntoView({behavior:"smooth",block:"start"})}toggleCrearUsuario(){this.animacionCrearUsuario=!this.animacionCrearUsuario}obtenerUsuarios(){return I(this,null,function*(){try{this.usuarios=yield this.authService.obtenerUsuarios()}catch(e){console.error("Error al obtener usuarios en el componente:",e)}})}onAnimationEnd(){this.animacionCrearUsuario=!1}getValue(e){return this.formReg.get(e)}updateValidators(e){e!==null&&(this.formReg.get("edad")?.clearValidators(),this.formReg.get("edad")?.reset(),this.formReg.get("obraSocial")?.clearValidators(),this.formReg.get("especialidad")?.clearValidators(),this.formReg.get("otraEspecialidad")?.clearValidators(),this.formReg.get("imagenPerfil")?.clearValidators(),this.formReg.get("imagenPerfil1")?.clearValidators(),this.formReg.get("imagenPerfil2")?.clearValidators(),e==="especialista"?(this.formReg.get("especialidad")?.setValidators([s.required]),this.formReg.get("especialidad")?.value==="otra"&&this.formReg.get("otraEspecialidad")?.setValidators([s.required]),this.formReg.get("imagenPerfil")?.setValidators([s.required]),this.formReg.get("obraSocial")?.setValidators([s.required]),this.formReg.get("obraSocial")?.clearValidators(),this.formReg.get("imagenPerfil1")?.clearValidators(),this.formReg.get("imagenPerfil2")?.clearValidators(),this.formReg.get("edad")?.setValidators([s.required,s.min(18),s.max(99)])):e==="paciente"?(this.formReg.get("edad")?.setValidators([s.required,s.min(1),s.max(99)]),this.formReg.get("especialidad")?.clearValidators(),this.formReg.get("otraEspecialidad")?.clearValidators(),this.formReg.get("imagenPerfil1")?.setValidators([s.required]),this.formReg.get("imagenPerfil2")?.setValidators([s.required]),this.formReg.get("imagenPerfil")?.clearValidators()):e==="admin"&&(this.formReg.get("especialidad")?.value==="otra"&&this.formReg.get("otraEspecialidad")?.setValidators([s.required]),this.formReg.get("edad")?.setValidators([s.required,s.min(18),s.max(99)]),this.formReg.get("imagenPerfil")?.setValidators([s.required]),this.formReg.get("obraSocial")?.setValidators([s.required]),this.formReg.get("obraSocial")?.clearValidators(),this.formReg.get("imagenPerfil1")?.clearValidators(),this.formReg.get("imagenPerfil2")?.clearValidators(),this.formReg.get("especialidad")?.clearValidators(),this.formReg.get("otraEspecialidad")?.clearValidators(),this.formReg.get("imagenPerfil1")?.setValidators([s.required]),this.formReg.get("imagenPerfil2")?.setValidators([s.required]),this.formReg.get("imagenPerfil")?.clearValidators()),this.formReg.get("obraSocial")?.updateValueAndValidity(),this.formReg.get("especialidad")?.updateValueAndValidity(),this.formReg.get("otraEspecialidad")?.updateValueAndValidity(),this.formReg.get("imagenPerfil0")?.updateValueAndValidity(),this.formReg.get("imagenPerfil")?.updateValueAndValidity(),this.formReg.get("imagenPerfil1")?.updateValueAndValidity(),this.formReg.get("imagenPerfil2")?.updateValueAndValidity())}toggleDropdown(){this.isDropdownOpen=!this.isDropdownOpen,this.showLogoutButton=this.isDropdownOpen}toggleCollapse(){this.collapsed=!this.collapsed,this.onToggleSideNav.emit({collapsed:this.collapsed,screenWidth:this.screenWidth})}closeSidenav(){this.collapsed=!1,this.onToggleSideNav.emit({collapsed:this.collapsed,screenWidth:this.screenWidth})}handleNavigation(e){e==="logout"&&this.logout()}onFileSelected0(e){this.imagenPerfil0=e.target.files[0]}onFileSelected(e){this.imagenPerfil=e.target.files[0]}onFileSelected1(e){this.imagenPerfil1=e.target.files[0]}onFileSelected2(e){this.imagenPerfil2=e.target.files[0]}logout(){return I(this,null,function*(){C.default.fire({title:"\xBFEst\xE1s seguro?",text:"Lamentamos que quieras salir...",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"S\xED, salir"}).then(e=>I(this,null,function*(){if(e.isConfirmed)try{console.log("Route link clicked: logout"),yield this.auth.signOut(),this.router.navigate(["/login"])}catch(a){console.error("Error al cerrar sesi\xF3n:",a)}else this.router.navigate(["/home"])}))})}sendEmailVerification(e){return I(this,null,function*(){yield ae(e)})}onSubmit(){return I(this,null,function*(){let e=this.formReg.get("password"),a=this.formReg.get("confirmPassword"),m=this.formReg.get("selectedRole")?.value,{email:g,password:w,confirmPassword:c}=this.formReg.value;if(w!==c){C.default.fire({icon:"error",title:"Error en la contrase\xF1a",text:"Las contrase\xF1as no coinciden. Por favor, verifica."}).then(()=>{e&&a&&(e.reset(),a.reset())});return}if(!m){C.default.fire({icon:"error",title:"Perfil no seleccionado",text:"Por favor, selecciona un perfil antes de registrarte."});return}this.showLoadingUser=!0;try{let E=yield this.auth.currentUser;(yield this.authService.checkIfUserExists(g))&&C.default.fire({icon:"error",title:"Usuario existente",text:"El correo electr\xF3nico ya est\xE1 registrado. Inicia sesi\xF3n en lugar de registrarte."}).then(()=>{if(e&&a){e.reset(),a.reset(),this.router.navigate(["/login"]);return}}),console.log("paso 1");let Oe=(yield this.authService.register(g,w)).user;if(yield this.auth.signOut(),E){let V=this.authService.getUserCredentials();V.email&&V.password&&(yield this.authService.reauthenticateUser(V.email,V.password))}let G=de(ce(this.firestore,"DatosUsuarios"),Oe.uid),O={mail:g,role:m,nombre:this.formReg.get("nombre")?.value,apellido:this.formReg.get("apellido")?.value,edad:this.formReg.get("edad")?.value,dni:this.formReg.get("dni")?.value};if(m==="paciente"){if(this.imagenPerfil1&&this.imagenPerfil2){let V=yield this.ImagenesService.uploadFile(this.imagenPerfil1),Ie=yield this.ImagenesService.uploadFile(this.imagenPerfil2);O=k(M({},O),{obrasocial:this.formReg.get("obraSocial")?.value,aprobadoPorAdmin:!0,imagenPerfil1:V,imagenPerfil2:Ie})}yield $(G,O,{merge:!0})}else if(m==="especialista"){if(this.imagenPerfil){let V=yield this.ImagenesService.uploadFile(this.imagenPerfil);O=k(M({},O),{especialidad:this.formReg.get("especialidad")?.value,otraEspecialidad:this.formReg.get("otraEspecialidad")?.value,aprobadoPorAdmin:!1,imagenPerfil:V})}yield $(G,O,{merge:!0})}else if(m==="admin"){if(this.imagenPerfil0){let V=yield this.ImagenesService.uploadFile(this.imagenPerfil0);O=k(M({},O),{aprobadoPorAdmin:!0,imagenPerfil:V})}yield $(G,O,{merge:!0})}this.cargarUsuarios(),this.showLoadingUser=!1,C.default.fire({icon:"success",title:"Registro exitoso",text:"\xA1El usuario ha sido creado exitosamente!",confirmButtonText:"OK"}).then(()=>{this.formReg.reset(),this.router.navigate(["/home/seccion-usuarios"]),this.scrollToTop()}),this.listaUsuariosComponent.cargarUsuarios()}catch(E){this.showLoadingUser=!1,E.message==="Debes verificar tu correo electr\xF3nico antes de iniciar sesi\xF3n."?(C.default.fire({icon:"warning",title:"Faltan validar tus datos",text:E.message}),this.router.navigate(["/login"])):E.code==="auth/invalid-email"?C.default.fire({icon:"error",title:"Error en el correo electr\xF3nico",text:"El formato del correo electr\xF3nico es incorrecto. Por favor, verifica."}):E.code==="auth/weak-password"?C.default.fire({icon:"error",title:"Contrase\xF1a d\xE9bil",text:"La contrase\xF1a es demasiado d\xE9bil. Debe contener al menos 6 caracteres."}).then(()=>{e&&a&&(e.reset(),a.reset())}):E.code==="auth/email-already-in-use"?C.default.fire({icon:"error",title:"Correo electr\xF3nico en uso",text:"El correo electr\xF3nico ya est\xE1 registrado. Inicia sesi\xF3n en lugar de registrarte."}):(console.error("Error en el registro:",E),C.default.fire({icon:"error",title:"Error en el registro",text:"Hubo un error al registrar tu cuenta. Por favor, verifica tus datos."}).then(()=>{e&&a&&(e.reset(),a.reset())}))}})}scrollToTop(){this.topElement&&this.topElement.nativeElement.scrollIntoView({behavior:"smooth",block:"start"})}actualizarListaUsuarios(){this.authService.obtenerUsuarios().then(e=>{console.log("Actualizando lista de usuarios:",e),this.usuarios=e}).catch(e=>{console.error("Error al actualizar lista de usuarios:",e)})}userLogged(){this.authService.getCurrentUser().subscribe(e=>{console.log(e?.email)},e=>{console.error("Error al obtener el usuario actual:",e)})}cargarUsuariosPendientes(){this.authService.obtenerUsuariosPendientesAprobacion().then(e=>{this.usuariosPendientes=e}).catch(e=>{console.error("Error al cargar usuarios pendientes:",e)})}aprobarUsuario(e){this.authService.aprobarUsuario(e).then(()=>{C.default.fire({icon:"success",title:"Usuario habilitado",text:"El usuario ha sido aprobado exitosamente."}),this.cargarUsuariosPendientes(),this.obtenerUsuarios()}).catch(a=>{C.default.fire({icon:"error",title:"Error al aprobar usuario",text:"Hubo un error al aprobar el usuario. Por favor, int\xE9ntalo de nuevo."})})}inhabilitarUsuario(e){this.authService.inhabilitarUsuario(e).then(()=>{C.default.fire({icon:"success",title:"Usuario inhabilitado",text:"El usuario ha sido aprobado exitosamente."}),this.cargarUsuariosPendientes(),this.obtenerUsuarios()}).catch(a=>{C.default.fire({icon:"error",title:"Error al aprobar usuario",text:"Hubo un error al aprobar el usuario. Por favor, int\xE9ntalo de nuevo."})})}activarLoading(){this.showLoadingUser=!0}};d.\u0275fac=function(a){return new(a||d)(P(re),P(Ee),P(Ue),P(B),P(j),P(se),P(le))},d.\u0275cmp=T({type:d,selectors:[["app-seccion-usuarios"]],viewQuery:function(a,m){if(a&1&&(F(je,5),F($e,5),F(W,5)),a&2){let g;L(g=N())&&(m.formulario=g.first),L(g=N())&&(m.topElement=g.first),L(g=N())&&(m.listaUsuariosComponent=g.first)}},outputs:{onToggleSideNav:"onToggleSideNav"},standalone:!0,features:[D],decls:18,vars:7,consts:[["topElement",""],[1,"navbar-custom"],["class","user-photo",3,"click",4,"ngIf"],["class","dropdown-content",4,"ngIf"],["charset","UTF-8"],[1,"btn","btn-user",3,"click"],["class","loading-overlay",4,"ngIf"],["class","container","id","crear-usuario-form",4,"ngIf"],[1,"center-button"],["type","button","value","Volver a inicio",1,"btn-success",3,"click"],[1,"user-photo",3,"click"],["alt","Foto de perfil de usuario","class","user-photo",3,"src",4,"ngIf"],["src","https://firebasestorage.googleapis.com/v0/b/tp-sala-de-juegos-diazgiossol.appspot.com/o/guest.webp?alt=media&token=69e91e4a-832d-4439-ab69-a30e2c8d80ee","class","user-photo",4,"ngIf"],["alt","Foto de perfil de usuario",1,"user-photo",3,"src"],["src","https://firebasestorage.googleapis.com/v0/b/tp-sala-de-juegos-diazgiossol.appspot.com/o/guest.webp?alt=media&token=69e91e4a-832d-4439-ab69-a30e2c8d80ee",1,"user-photo"],[1,"dropdown-content"],["class","logout-button",3,"click",4,"ngIf"],[1,"logout-button",3,"click"],[1,"fa","solid","fa-power-off"],[1,"loading-overlay"],[1,"spinner-container"],[1,"spinner"],[1,"loading-text"],["id","crear-usuario-form",1,"container"],[1,"add-user-form",3,"ngSubmit","formGroup"],[1,"form-row"],["for","selectedRole"],["id","selectedRole","name","selectedRole","formControlName","selectedRole","required",""],["value","admin"],["value","especialista"],["value","paciente"],["for","nombre",1,"form-label"],["type","text","formControlName","nombre","id","nombre","minlength","3","maxlength","20","placeholder","","required","",1,"form-control"],["class","errorMessage",4,"ngIf"],["for","apellido",1,"form-label"],["type","text","formControlName","apellido","id","apellido","minlength","3","maxlength","20","placeholder","","required","",1,"form-control"],["for","edad",1,"form-label"],["type","text","formControlName","edad","id","edad","placeholder","","minlength","2","maxlength","2","required","",1,"form-control"],["for","dni",1,"form-label"],["type","text","formControlName","dni","id","dni","placeholder","","minlength","7","maxlength","8","required","",1,"form-control"],["for","email"],["type","email","id","email","formControlName","email","minlength","6","maxlength","40","placeholder","Email","required",""],["for","password"],["type","password","id","password","formControlName","password","minlength","6","maxlength","8","placeholder","Contrase\xF1a","required",""],["for","confirmPassword"],["type","password","id","confirmPassword","formControlName","confirmPassword","minlength","6","maxlength","8","placeholder","Reingresar Contrase\xF1a","required",""],[4,"ngIf"],["type","button",1,"btn-reg",3,"click"],[1,"errorMessage"],["for","imagenPerfil"],["type","file","id","imagenPerfil0","formControlName","imagenPerfil0","accept","image/*","required","",3,"change"],["for","obraSocial"],["type","text","id","obraSocial","formControlName","obraSocial","placeholder","Obra Social","required",""],["for","imagenPerfil1"],["type","file","id","imagenPerfil1","formControlName","imagenPerfil1","accept","image/*","required","",3,"change"],["for","imagenPerfil2"],["type","file","id","imagenPerfil2","formControlName","imagenPerfil2","accept","image/*","required","",3,"change"],["for","especialidad"],["id","especialidad","formControlName","especialidad","required",""],["value","Ginecologia"],["value","Traumatologia"],["value","Kinesiologia"],["value","Nutricionista"],["value","otra"],["class","form-group",4,"ngIf"],["type","file","id","imagenPerfil","formControlName","imagenPerfil","accept","image/*","required","",3,"change"],[1,"form-group"],["for","otraEspecialidad"],["type","text","id","otraEspecialidad","formControlName","otraEspecialidad","minlength","4","maxlength","25","placeholder","Especialidad personalizada","required",""]],template:function(a,m){if(a&1){let g=S();r(0,"div",1,0),p(2,Ge,4,3,"a",2),te(3,"async"),p(4,He,2,1,"div",3),i(),r(5,"head")(6,"title"),n(7,"Secci\xF3n de Usuarios"),i(),h(8,"meta",4),i(),r(9,"body"),h(10,"app-lista-usuarios"),r(11,"button",5),_("click",function(){return b(g),x(m.toggleFormulario())})("click",function(){return b(g),x(m.toggleCrearUsuario())}),n(12),i(),h(13,"header"),p(14,Ze,5,0,"div",6)(15,ht,49,25,"div",7),r(16,"div",8)(17,"input",9),_("click",function(){return b(g),x(m.goTo("/home"))}),i()()()}a&2&&(l(2),u("ngIf",ie(3,5,m.currentUser$)),l(2),u("ngIf",m.isDropdownOpen),l(8),U(" ",m.mostrarFormulario?"Ocultar Formulario":"Crear usuario"," "),l(2),u("ngIf",m.showLoadingUser),l(),u("ngIf",m.mostrarFormulario))},dependencies:[z,A,ne,Ve,he,xe,Ce,ue,be,ge,pe,Pe,Se,we,ye,_e,ve,W],styles:["body[_ngcontent-%COMP%]{background-image:url(/assets/fondoClinica.jpg);background-size:cover;background-position:center;background-repeat:no-repeat;margin:0;padding:0;min-height:100vh;height:auto;font-family:Euclid Circular A,Poppins}.container[_ngcontent-%COMP%]{max-width:915px;margin:20px auto 0;padding:20px;background-color:#fff;box-shadow:0 0 10px #00000093;overflow:auto;transition:all .5s ease-in-out}header[_ngcontent-%COMP%]{text-align:center;background-color:#dddbdb;color:#000;font-size:24px}nav[_ngcontent-%COMP%]{background-color:#dddbdb;padding:5px;text-align:center}nav[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{color:#fff;text-decoration:none;margin:0 10px;font-weight:700;transition:color .3s}nav[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{color:#c696fd}.user-list[_ngcontent-%COMP%]{list-style:none;padding:0}.user[_ngcontent-%COMP%]{display:flex;justify-content:space-between;border:1px solid #ccc;margin:10px 0;padding:10px}.user-info[_ngcontent-%COMP%]{flex:1}.user-actions[_ngcontent-%COMP%]{display:flex;flex-direction:column}.add-user-form[_ngcontent-%COMP%]{max-width:100%;margin:0 auto;display:grid;grid-template-columns:repeat(3,1fr);gap:10px;background-color:#f5f5f5;padding:4px;border:1px solid #ccc;border-radius:5px;text-align:center}.add-user-form[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-weight:700}.add-user-form[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .add-user-form[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{width:100%;padding:10px;border:1px solid #ccc;border-radius:5px;margin-bottom:5px;text-align:center}.add-user-button[_ngcontent-%COMP%]{background-color:#007bff;color:#fff;border:none;border-radius:5px;padding:10px;cursor:pointer;font-weight:700;transition:background-color .3s;margin-top:10px;margin-bottom:15px}.add-user-button[_ngcontent-%COMP%]:hover{background-color:#0056b3}footer[_ngcontent-%COMP%]{text-align:center;background-color:#dddbdb;color:#fff}button[_ngcontent-%COMP%]{background-color:#28a745;color:#fff;border:none;border-radius:5px;font-size:18px;font-weight:700;padding:10px 20px;cursor:pointer;margin-top:10px;width:100%;transition:background-color .2s}button[_ngcontent-%COMP%]:hover{background-color:#04d454}.disable-access[_ngcontent-%COMP%]{background-color:#d31c1c}.disable-access[_ngcontent-%COMP%]:hover{background-color:red}.edit-user[_ngcontent-%COMP%]{background-color:#a7a7a7}.edit-user[_ngcontent-%COMP%]:hover{background-color:#7c7c7c}.btn-success[_ngcontent-%COMP%]{background-color:#a72892;color:#fff;border:none;padding:10px 20px;margin:28px;border-radius:5px;font-size:18px;font-weight:700;cursor:pointer;transition:background-color .3s}.btn-success[_ngcontent-%COMP%]:hover{background-color:#7f196e}.center-button[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center}.centered-loading[_ngcontent-%COMP%]{position:fixed;inset:0;display:flex;justify-content:center;align-items:center;background-color:#ffffffb3;z-index:9999}.navbar-custom[_ngcontent-%COMP%]{position:fixed;top:0;right:0;padding:10px 20px;z-index:1000;margin-right:250px;display:flex;align-items:center;font-family:Euclid Circular A,Poppins}.navbar-custom[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{color:#000;text-decoration:none;cursor:pointer;display:flex;align-items:center}.user-photo[_ngcontent-%COMP%]{width:2rem;min-width:2rem;height:2rem;border-radius:50%;margin-right:.5rem}.fa-solid[_ngcontent-%COMP%]   fa-power-off[_ngcontent-%COMP%]{color:#000;width:5rem;min-width:5rem;height:5rem}.logout-button[_ngcontent-%COMP%]{margin-left:auto;cursor:pointer;width:2rem;height:2rem;border-radius:50%;background-color:transparent;border:none;color:#000;display:flex;align-items:center;position:relative;font-family:Euclid Circular A,Poppins}.logout-button[_ngcontent-%COMP%]   i.fa[_ngcontent-%COMP%]{font-size:1.5rem;margin-right:.5rem}.dropdown-content[_ngcontent-%COMP%]{position:absolute;top:calc(65% + 10px);right:0;text-align:center;border-radius:.313rem;padding:.2rem;min-width:10rem}.dropdown-content[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{width:100%;border:none;background:transparent;color:#000;cursor:pointer;display:flex;align-items:center;padding:.5rem 0;transition:background-color .3s}.logout-button[_ngcontent-%COMP%]:hover + .dropdown-content[_ngcontent-%COMP%]{display:block}.site-footer[_ngcontent-%COMP%]{position:absolute;bottom:0;width:100%;text-align:center}h2[_ngcontent-%COMP%]{text-align:center}.users-column[_ngcontent-%COMP%]{max-height:400px;overflow-y:auto}.sticky-header[_ngcontent-%COMP%]{position:sticky;top:0;background-color:#fff;z-index:100}img[_ngcontent-%COMP%]{border:2px solid #ccc;width:80px;height:80px;object-fit:cover}.btn-reg[_ngcontent-%COMP%]{cursor:pointer;width:200px}.errorMessage[_ngcontent-%COMP%]{color:red;text-align:center}input.campo-con-error[_ngcontent-%COMP%]{border:1px solid red}.site-footer[_ngcontent-%COMP%]{position:absolute;bottom:0;width:100%;text-align:center;color:#000}.site-footer[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;font-size:14px}#crearUsuarioForm[_ngcontent-%COMP%]{transition:max-height .3s ease-out;max-height:500px;overflow:hidden}.collapsing[_ngcontent-%COMP%]{max-height:0!important;transition:max-height .3s ease-in}.slide-in-bottom[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_slide-in-bottom .5s cubic-bezier(.25,.46,.45,.94) both}@keyframes _ngcontent-%COMP%_slide-in-bottom{0%{transform:translateY(1000px);opacity:0}to{transform:translateY(0);opacity:1}}.btn-user[_ngcontent-%COMP%]{background-color:#28a745;color:#fff;border:none;width:300px;display:block;margin:20px auto 0}.btn-user[_ngcontent-%COMP%]:hover{background-color:#04d454}.loading-overlay[_ngcontent-%COMP%]{position:fixed;inset:0;background-color:#ffffffb3;-webkit-backdrop-filter:blur(5px);backdrop-filter:blur(5px);z-index:9999;display:flex;justify-content:center;align-items:center}.spinner-container[_ngcontent-%COMP%]{text-align:center}.spinner[_ngcontent-%COMP%]{border:4px solid rgba(0,0,0,.1);border-top:4px solid #000;border-radius:50%;width:50px;height:50px;animation:_ngcontent-%COMP%_spin 1s linear infinite;margin-bottom:20px;margin-left:40px}.loading-text[_ngcontent-%COMP%]{font-size:17px;font-weight:700;color:#000;margin-top:15px}@keyframes _ngcontent-%COMP%_spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}"]});let t=d;return t})();export{qt as SeccionUsuariosComponent};
